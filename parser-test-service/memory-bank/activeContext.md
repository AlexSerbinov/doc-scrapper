# Active Context - Doc Scrapper

## –ü–æ—Ç–æ—á–Ω–∏–π —Ñ–æ–∫—É—Å —Ä–æ–±–æ—Ç–∏

### üö® –ö–†–ò–¢–ò–ß–ù–ê –ü–†–û–ë–õ–ï–ú–ê
**–§–æ—Ä–º–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó —Ç—Ä—ñ–∞–ª—É –Ω–µ –ø—Ä–∞—Ü—é—î** - –æ—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∞ –¥–æ backend.

### –î—ñ–∞–≥–Ω–æ–∑ –ø—Ä–æ–±–ª–µ–º–∏
1. ‚úÖ **RAG —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞—Ü—é—î** - API –Ω–∞ –ø–æ—Ä—Ç—É 8001 –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î
2. ‚úÖ **ChromaDB –ø—Ä–∞—Ü—é—î** - –≤–µ–∫—Ç–æ—Ä–Ω–∞ –±–∞–∑–∞ –Ω–∞ –ø–æ—Ä—Ç—É 8000 –∞–∫—Ç–∏–≤–Ω–∞  
3. ‚úÖ **CLI Scraper –ø—Ä–∞—Ü—é—î** - –º–æ–∂–µ —Å–∫—Ä–∞–ø–∏—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –ø—Ä–æ–≥—Ä–∞–º–Ω–æ
4. ‚úÖ **Web UI –ø—Ä–∞—Ü—é—î** - —Ñ–æ—Ä–º–∞ –≤–∏–≥–ª—è–¥–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω–æ —ñ –ø–æ–∫–∞–∑—É—î ProcessingModal
5. ‚ùå **–í–Ü–î–°–£–¢–ù–Ø –Ü–ù–¢–ï–ì–†–ê–¶–Ü–Ø** - —Ñ–æ—Ä–º–∞ —Ç—ñ–ª—å–∫–∏ –ø–æ–∫–∞–∑—É—î mock UI, –Ω–µ –≤–∏–∫–ª–∏–∫–∞—î —Ä–µ–∞–ª—å–Ω–∏–π —Å–∫—Ä–∞–ø—ñ–Ω–≥

### –ü–æ—Ç–æ—á–Ω–µ —Ä–æ–∑—É–º—ñ–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏
```
[Web Form] ‚Üí [Mock ProcessingModal] ‚Üí [Chat Interface]
     ‚ùå             ‚ùå                        ‚úÖ
   (–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∞ –¥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ backend)
```

### –ü–æ—Ç—Ä—ñ–±–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
```
[Web Form] ‚Üí [API /api/scrape] ‚Üí [CLI Scraper] ‚Üí [ChromaDB] ‚Üí [Chat Ready]
     ‚úÖ              ‚úÖ              ‚úÖ             ‚úÖ            ‚úÖ
```

## –û—Å—Ç–∞–Ω–Ω—ñ –∑–º—ñ–Ω–∏ —Ç–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è

### 2025-01-06 - –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –µ–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä—ñ–≤ —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è API endpoint

#### ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –∑ Jina Reader API –≤–∏—Ä—ñ—à–µ–Ω–∞
- **–ü—Ä–æ–±–ª–µ–º–∞**: Jina Reader API –æ–±–º–µ–∂–µ–Ω–∏–π –¥–æ 20 –∑–∞–ø–∏—Ç—ñ–≤/—Ö–≤–∏–ª–∏–Ω—É (–∑–∞–Ω–∞–¥—Ç–æ –ø–æ–≤—ñ–ª—å–Ω–æ –¥–ª—è 487 —Å—Ç–æ—Ä—ñ–Ω–æ–∫)
- **–†—ñ—à–µ–Ω–Ω—è**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ JavaScript —Ç–∞ Static —Ä–µ–∂–∏–º–∏

#### ‚úÖ –£—Å–ø—ñ—à–Ω–∏–π —Ç–µ—Å—Ç —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 10 —Å—Ç–æ—Ä—ñ–Ω–æ–∫ AI SDK —Å–∫—Ä–∞–ø–∞–Ω–æ –∑–∞ 65 —Å–µ–∫—É–Ω–¥
- **–ó–Ω–∞–π–¥–µ–Ω–æ**: 487 URLs –≤ sitemap
- **–ú–µ—Ç–æ–¥**: JavaScript extraction –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –Ω–∞–≤—ñ—Ç—å –≤ static mode
- **–®–≤–∏–¥–∫—ñ—Å—Ç—å**: ~9 —Å–µ–∫—É–Ω–¥ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É (–≤–∫–ª—é—á–∞—é—á–∏ rate limiting)

#### ‚úÖ API endpoint —Å—Ç–≤–æ—Ä–µ–Ω–æ
- **–§–∞–π–ª**: `web-app/src/app/api/scrape/route.ts`  
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**:
  - POST endpoint –ø—Ä–∏–π–º–∞—î URL —Ç–∞ mode –µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è collection name –∑ URL
  - Child process spawn –¥–ª—è CLI scraper
  - –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 3 —Ä–µ–∂–∏–º—ñ–≤: `js`, `static`, `jina`
  - –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ concurrency —Ç–∞ delay –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É

#### üöß –ó–∞–ø—É—â–µ–Ω–æ –ø–æ–≤–Ω–∏–π —Å–∫—Ä–∞–ø—ñ–Ω–≥ AI SDK
- **–°—Ç–∞—Ç—É—Å**: –í –ø—Ä–æ—Ü–µ—Å—ñ (background process)
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏**: static mode, 10 concurrency, 200ms delay
- **–û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏**: 487 —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —á–µ—Ä–µ–∑ ~2-3 –≥–æ–¥–∏–Ω–∏

### –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –ø—ñ–¥ —á–∞—Å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
1. **CLI scraper —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±–∏—Ä–∞—î –æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–π –º–µ—Ç–æ–¥
2. **Static mode —à–≤–∏–¥—à–∏–π** - –º–µ–Ω—à–µ timeout –ø–æ–º–∏–ª–æ–∫ –Ω—ñ–∂ JS mode
3. **API integration –≥–æ—Ç–æ–≤–∞** - endpoint –ø—Ä–∞—Ü—é—î, —Ç—ñ–ª—å–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ UI
4. **Rate limiting –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π** - 200ms delay –∑–∞–ø–æ–±—ñ–≥–∞—î –±–ª–æ–∫—É–≤–∞–Ω–Ω—é

## –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 1: –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ —Ñ–æ—Ä–º—É –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó —Ç—Ä—ñ–∞–ª—É ‚úÖ (–ß–ê–°–¢–ö–û–í–û)
- [‚úÖ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `/api/scrape` endpoint —É Next.js
- [‚úÖ] –Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –≤–∏–∫–ª–∏–∫ CLI scraper —á–µ—Ä–µ–∑ child_process
- [‚úÖ] –î–æ–¥–∞—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö session ID
- [‚úÖ] –Ü–º–ø–ª–µ–º–µ–Ω—Ç—É–≤–∞—Ç–∏ collection name generation
- [ ] **–ù–ê–°–¢–£–ü–ù–ò–ô –ö–†–û–ö**: –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ HeroSection —Ñ–æ—Ä–º—É –¥–æ API endpoint

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 2: Real-time –ø—Ä–æ–≥—Ä–µ—Å  
- [ ] –î–æ–¥–∞—Ç–∏ Server-Sent Events –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—É —Å–∫—Ä–∞–ø—ñ–Ω–≥—É
- [ ] –û–Ω–æ–≤–∏—Ç–∏ ProcessingModal –¥–ª—è –ø–æ–∫–∞–∑—É —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—É
- [ ] –î–æ–¥–∞—Ç–∏ error handling —Ç–∞ timeout management

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 3: –ó–∞–≤–µ—Ä—à–∏—Ç–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ RAG
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—è –ø—ñ—Å–ª—è —Å–∫—Ä–∞–ø—ñ–Ω–≥—É
- [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è RAG API –Ω–∞ –Ω–æ–≤—É –∫–æ–ª–µ–∫—Ü—ñ—é
- [ ] –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ —á–∞—Ç –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è

## –ê–∫—Ç–∏–≤–Ω—ñ —Ç–µ—Ö–Ω—ñ—á–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è

### ‚úÖ –û–±—Ä–∞–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è –µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó
**Static Mode –∑ JS fallback** - –Ω–∞–π–∫—Ä–∞—â–∏–π –±–∞–ª–∞–Ω—Å —à–≤–∏–¥–∫–æ—Å—Ç—ñ —Ç–∞ —è–∫–æ—Å—Ç—ñ:

```typescript
// –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ä–µ–∂–∏–º—ñ–≤
const concurrency = extractionMode === 'static' ? '20' : '15';
const delay = extractionMode === 'static' ? '50' : '100';
```

### ‚úÖ Collection naming strategy
```typescript
function generateCollectionName(url: string): string {
  const urlObj = new URL(url);
  const domain = urlObj.hostname.replace(/^www\./, '');
  const pathParts = urlObj.pathname.split('/').filter(Boolean);
  
  const name = pathParts.length > 0 
    ? `${domain}-${pathParts[0]}`  // ai-sdk-dev-docs
    : domain;
  
  return name.replace(/[^a-zA-Z0-9-]/g, '-').toLowerCase();
}
```

### ‚úÖ API endpoint –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
```typescript
// POST /api/scrape
{
  "url": "https://ai-sdk.dev/docs/introduction",
  "extractionMode": "static", // js | static | jina
  "collectionName": "custom-name" // optional
}

// Response
{
  "success": true,
  "sessionId": "aHR0cHM6-lw3qy4jo",
  "collectionName": "ai-sdk-dev-docs",
  "message": "Scraping started successfully with static mode"
}
```

## –ü–æ—Ç–æ—á–Ω—ñ —Ç–µ—Ö–Ω—ñ—á–Ω—ñ –º—ñ—Ä–∫—É–≤–∞–Ω–Ω—è

### Performance —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
- **Static mode**: ~9 —Å–µ–∫/—Å—Ç–æ—Ä—ñ–Ω–∫–∞ (–∑ rate limiting)
- **Concurrent processes**: 10-15 –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –±–ª–æ–∫—É–≤–∞–Ω—å
- **Memory usage**: —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π, –±–µ–∑ leak'—ñ–≤
- **Error rate**: ~5% timeout –ø–æ–º–∏–ª–∫–∏ (–ø—Ä–∏–π–Ω—è—Ç–Ω–æ)

### –ù–∞—Å—Ç—É–ø–Ω—ñ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
1. **Adaptive rate limiting** - –∑–±—ñ–ª—å—à—É–≤–∞—Ç–∏ delay –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö
2. **Smart retry** - –ø–æ–≤—Ç–æ—Ä–Ω—ñ —Å–ø—Ä–æ–±–∏ –¥–ª—è failed pages
3. **Progress streaming** - real-time updates —á–µ—Ä–µ–∑ SSE
4. **Collection indexing** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ RAG —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—è –ø—ñ—Å–ª—è scraping

## –ë–ª–æ–∫–µ—Ä–∏ —Ç–∞ –ø–∏—Ç–∞–Ω–Ω—è

### ‚úÖ –í–∏—Ä—ñ—à–µ–Ω—ñ
- [‚úÖ] CLI –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ - –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º–∫—É –≤—Å—ñ—Ö –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –æ–ø—Ü—ñ–π
- [‚úÖ] Environment setup - env variables –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è
- [‚úÖ] Collection naming - ChromaDB-compatible –Ω–∞–∑–≤–∏ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è
- [‚úÖ] Rate limiting - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–Ω–∞–π–¥–µ–Ω—ñ

### –ó–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤–∏—Ä—ñ—à–∏—Ç–∏
1. **UI Integration** - –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ HeroSection.tsx –¥–æ API endpoint
2. **Real-time feedback** - SSE –¥–ª—è progress tracking
3. **Error handling** - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏
4. **RAG integration** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è –∫–æ–ª–µ–∫—Ü—ñ–π –ø—ñ—Å–ª—è scraping

### –¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è
- –ß–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ session state –º—ñ–∂ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏ —Å–µ—Ä–≤–µ—Ä–∞?
- –Ø–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ concurrent scraping requests?
- –Ø–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è –¥–ª—è cleanup —Å—Ç–∞—Ä–∏—Ö scraped files? 